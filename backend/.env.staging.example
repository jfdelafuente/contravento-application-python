# =============================================================================
# ContraVento Backend - STAGING Environment Variables
# =============================================================================
# This is a template for staging environment. Create .env.staging with real values.
# NEVER commit .env.staging to version control!
#
# STAGING: Pre-production environment for final testing before production release

# =============================================================================
# APPLICATION
# =============================================================================

APP_NAME=ContraVento-Staging
APP_ENV=staging
DEBUG=false

# =============================================================================
# DATABASE - PostgreSQL (REQUIRED for staging)
# =============================================================================

# PostgreSQL connection URL
# Format: postgresql+asyncpg://user:password@host:port/database
# Use separate database from production
DATABASE_URL=postgresql+asyncpg://contravento_staging:CHANGE_THIS_PASSWORD@postgres:5432/contravento_staging

# Database password (for docker-compose)
DB_PASSWORD=CHANGE_THIS_PASSWORD

# =============================================================================
# REDIS - Caching & Sessions
# =============================================================================

# Redis connection URL (use separate Redis instance or different DB index)
REDIS_URL=redis://:CHANGE_THIS_PASSWORD@redis:6379/1

# Redis password (for docker-compose)
REDIS_PASSWORD=CHANGE_THIS_PASSWORD

# =============================================================================
# SECURITY - JWT & AUTHENTICATION
# =============================================================================

# Secret key for JWT signing (MUST BE DIFFERENT FROM PRODUCTION)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(64))"
# IMPORTANT: Use a different key than production
SECRET_KEY=GENERATE_DIFFERENT_SECRET_KEY_FROM_PRODUCTION_MIN_64_CHARS

# JWT algorithm (recommended: HS256)
ALGORITHM=HS256

# Access token expiration (minutes)
# Staging: 15 minutes (same as production)
ACCESS_TOKEN_EXPIRE_MINUTES=15

# Refresh token expiration (days)
# Staging: 30 days (same as production)
REFRESH_TOKEN_EXPIRE_DAYS=30

# =============================================================================
# SECURITY - PASSWORD HASHING
# =============================================================================

# Bcrypt rounds for password hashing
# Staging: 12 (same as production to test performance)
BCRYPT_ROUNDS=12

# =============================================================================
# EMAIL / SMTP - Test Mail Service or Real Service
# =============================================================================

# Option 1: Real SMTP service (recommended for realistic testing)
# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USER=apikey
# SMTP_PASSWORD=YOUR_SENDGRID_API_KEY
# SMTP_FROM=staging@contravento.com
# SMTP_TLS=true

# Option 2: MailHog for email testing (easier for QA team)
SMTP_HOST=mailhog
SMTP_PORT=1025
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=staging@contravento.com
SMTP_TLS=false

# =============================================================================
# FILE STORAGE
# =============================================================================

# Storage path (inside container)
STORAGE_PATH=/app/storage

# Maximum upload size (MB)
UPLOAD_MAX_SIZE_MB=5

# Profile photo size (pixels)
PROFILE_PHOTO_SIZE=400

# =============================================================================
# TRAVEL DIARY - SETTINGS
# =============================================================================

# Maximum photos per trip
MAX_PHOTOS_PER_TRIP=20

# Maximum tags per trip
MAX_TAGS_PER_TRIP=10

# Photo quality settings
PHOTO_QUALITY_OPTIMIZED=85
PHOTO_QUALITY_THUMB=80
PHOTO_MAX_WIDTH=1200
PHOTO_THUMB_SIZE=200

# =============================================================================
# CORS - Staging Domains
# =============================================================================

# Allowed origins (staging domains + localhost for QA testing)
# Include staging frontend URL
CORS_ORIGINS=https://staging.contravento.com,http://localhost:3000,http://localhost:5173

# =============================================================================
# RATE LIMITING
# =============================================================================

# Maximum failed login attempts
LOGIN_MAX_ATTEMPTS=5

# Account lock duration (minutes)
LOGIN_LOCKOUT_MINUTES=15

# Max verification emails per hour
VERIFICATION_EMAIL_MAX_PER_HOUR=3

# =============================================================================
# LOGGING
# =============================================================================

# Log level (staging: DEBUG for troubleshooting)
LOG_LEVEL=DEBUG

# Log format (json for structured logs, easier for debugging)
LOG_FORMAT=json

# =============================================================================
# SERVER
# =============================================================================

# Server bind address
HOST=0.0.0.0

# Server port
PORT=8000

# =============================================================================
# MONITORING & OBSERVABILITY (Optional)
# =============================================================================

# Sentry DSN for error tracking (use staging project)
# SENTRY_DSN=https://your-staging-sentry-dsn@sentry.io/staging-project-id

# Environment tag for monitoring services
SENTRY_ENVIRONMENT=staging

# =============================================================================
# ADMIN & UTILITIES
# =============================================================================

# pgAdmin password (for database UI)
PGADMIN_PASSWORD=CHANGE_THIS_PASSWORD

# =============================================================================
# STAGING DEPLOYMENT CHECKLIST
# =============================================================================
# Before deploying to staging, verify:
#
# [ ] APP_ENV=staging
# [ ] DEBUG=false (production-like behavior)
# [ ] Unique SECRET_KEY (different from production and development)
# [ ] DATABASE_URL uses separate staging database
# [ ] DB_PASSWORD is strong (different from production)
# [ ] REDIS_PASSWORD is strong (different from production)
# [ ] BCRYPT_ROUNDS=12 (same as production for performance testing)
# [ ] SMTP configured (MailHog for easy testing OR real SMTP)
# [ ] CORS_ORIGINS includes staging domain + localhost for QA
# [ ] All passwords are not "changeme"
# [ ] .env.staging is in .gitignore
# [ ] Monitoring configured to separate staging project/environment
#
# =============================================================================

# =============================================================================
# STAGING DEPLOYMENT INSTRUCTIONS
# =============================================================================
#
# 1. Copy this file to .env.staging:
#    cp .env.staging.example .env.staging
#
# 2. Generate strong SECRET_KEY (DIFFERENT from production):
#    python -c "import secrets; print(secrets.token_urlsafe(64))"
#
# 3. Generate strong passwords for DB and Redis:
#    python -c "import secrets; print(secrets.token_urlsafe(32))"
#
# 4. Choose email option:
#    - MailHog: Keep defaults (easier for QA)
#    - Real SMTP: Configure with real service (more realistic)
#
# 5. Set CORS_ORIGINS to staging domain + localhost for testing
#
# 6. Deploy with Docker Compose:
#    docker-compose --env-file backend/.env.staging --profile development up -d
#
#    Note: Use --profile development to include MailHog and pgAdmin
#
# 7. Verify deployment:
#    curl https://staging.contravento.com/health
#    curl http://localhost:8000/health  # Local staging
#
# 8. Monitor logs:
#    docker-compose logs -f backend
#
# 9. Access services:
#    - API: http://localhost:8000
#    - API Docs: http://localhost:8000/docs (if DEBUG=true)
#    - MailHog UI: http://localhost:8025
#    - pgAdmin: http://localhost:5050
#
# =============================================================================
