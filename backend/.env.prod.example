# =============================================================================
# ContraVento Backend - PRODUCTION Environment Variables
# =============================================================================
# CRITICAL: This is a template for production. Create .env.prod with real values.
# NEVER commit .env.prod to version control!

# =============================================================================
# APPLICATION
# =============================================================================

APP_NAME=ContraVento
APP_ENV=production
DEBUG=false

# =============================================================================
# DATABASE - PostgreSQL (REQUIRED for production)
# =============================================================================

# PostgreSQL connection URL
# Format: postgresql+asyncpg://user:password@host:port/database
# CRITICAL: Use strong password, not the default
DATABASE_URL=postgresql+asyncpg://contravento_user:CHANGE_THIS_PASSWORD@postgres:5432/contravento

# Database password (for docker-compose)
DB_PASSWORD=CHANGE_THIS_PASSWORD

# =============================================================================
# REDIS - Caching & Sessions
# =============================================================================

# Redis connection URL
REDIS_URL=redis://:CHANGE_THIS_PASSWORD@redis:6379/0

# Redis password (for docker-compose)
REDIS_PASSWORD=CHANGE_THIS_PASSWORD

# =============================================================================
# SECURITY - JWT & AUTHENTICATION
# =============================================================================

# Secret key for JWT signing (CRITICAL - MUST BE STRONG AND UNIQUE)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(64))"
# CRITICAL: Must be different from development/staging
# CRITICAL: Minimum 32 characters, recommended 64+
SECRET_KEY=GENERATE_STRONG_SECRET_KEY_WITH_COMMAND_ABOVE_MIN_64_CHARS

# JWT algorithm (recommended: HS256)
ALGORITHM=HS256

# Access token expiration (minutes)
# Production: 15 minutes (security vs UX balance)
ACCESS_TOKEN_EXPIRE_MINUTES=15

# Refresh token expiration (days)
# Production: 7-30 days
REFRESH_TOKEN_EXPIRE_DAYS=30

# =============================================================================
# SECURITY - PASSWORD HASHING
# =============================================================================

# Bcrypt rounds for password hashing
# Production: 12-14 (higher = more secure but slower)
# CRITICAL: Do NOT use less than 12 in production
BCRYPT_ROUNDS=12

# =============================================================================
# EMAIL / SMTP - Production Mail Service
# =============================================================================

# SMTP server (use real mail service)
# Options: SendGrid, AWS SES, Mailgun, Gmail (with app password)
SMTP_HOST=smtp.sendgrid.net

# SMTP port (587 for STARTTLS, 465 for SSL)
SMTP_PORT=587

# SMTP username
# SendGrid: "apikey"
# AWS SES: your IAM access key
# Gmail: your-email@gmail.com
SMTP_USER=apikey

# SMTP password
# SendGrid: your API key
# AWS SES: your IAM secret key
# Gmail: app-specific password
SMTP_PASSWORD=YOUR_SENDGRID_API_KEY_OR_SMTP_PASSWORD

# Email sender address
SMTP_FROM=noreply@contravento.com

# Enable TLS/SSL (CRITICAL: true for production)
SMTP_TLS=true

# =============================================================================
# FILE STORAGE
# =============================================================================

# Storage path (inside container)
STORAGE_PATH=/app/storage

# Maximum upload size (MB)
UPLOAD_MAX_SIZE_MB=5

# Profile photo size (pixels)
PROFILE_PHOTO_SIZE=400

# =============================================================================
# CORS - CRITICAL SECURITY SETTING
# =============================================================================

# Allowed origins (CRITICAL: Only your production domains)
# NEVER use "*" in production
# Separate multiple origins with commas
# MUST include https:// protocol
CORS_ORIGINS=https://contravento.com,https://www.contravento.com

# =============================================================================
# RATE LIMITING
# =============================================================================

# Maximum failed login attempts
LOGIN_MAX_ATTEMPTS=5

# Account lock duration (minutes)
LOGIN_LOCKOUT_MINUTES=15

# Max verification emails per hour
VERIFICATION_EMAIL_MAX_PER_HOUR=3

# =============================================================================
# LOGGING
# =============================================================================

# Log level (production: INFO or WARNING)
LOG_LEVEL=INFO

# Log format (production: json for structured logs)
LOG_FORMAT=json

# =============================================================================
# SERVER
# =============================================================================

# Server bind address (0.0.0.0 to listen on all interfaces)
HOST=0.0.0.0

# Server port
PORT=8000

# =============================================================================
# MONITORING & OBSERVABILITY (Optional)
# =============================================================================

# Sentry DSN for error tracking
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# Application Insights (Azure)
# APPLICATIONINSIGHTS_CONNECTION_STRING=your-connection-string

# =============================================================================
# ADMIN & UTILITIES
# =============================================================================

# pgAdmin password (for database UI - development/staging only)
PGADMIN_PASSWORD=CHANGE_THIS_PASSWORD

# =============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# =============================================================================
# Before deploying to production, verify ALL of these:
#
# [ ] APP_ENV=production
# [ ] DEBUG=false
# [ ] Strong, unique SECRET_KEY (64+ chars, generated not copied)
# [ ] DATABASE_URL uses PostgreSQL (not SQLite)
# [ ] DB_PASSWORD is strong (16+ chars, random)
# [ ] REDIS_PASSWORD is strong (16+ chars, random)
# [ ] BCRYPT_ROUNDS=12 or higher
# [ ] SMTP configured with real mail service (not localhost/MailHog)
# [ ] SMTP_TLS=true
# [ ] CORS_ORIGINS restricted to your domain(s) ONLY (no localhost, no *)
# [ ] All passwords are production-grade (not "changeme")
# [ ] .env.prod is in .gitignore (NEVER commit to git)
# [ ] Environment variables are set in hosting platform (not in .env.prod)
# [ ] HTTPS is enforced (handled by reverse proxy/load balancer)
# [ ] Database backups are configured
# [ ] Monitoring/alerting is configured (Sentry, etc.)
# [ ] Log aggregation is configured (CloudWatch, DataDog, etc.)
# [ ] Rate limiting is enabled
# [ ] Firewall rules are configured
# [ ] SSL certificates are valid and auto-renewing
#
# =============================================================================

# =============================================================================
# DEPLOYMENT INSTRUCTIONS
# =============================================================================
#
# 1. Copy this file to .env.prod:
#    cp .env.prod.example .env.prod
#
# 2. Generate strong SECRET_KEY:
#    python -c "import secrets; print(secrets.token_urlsafe(64))"
#
# 3. Generate strong passwords for DB and Redis:
#    python -c "import secrets; print(secrets.token_urlsafe(32))"
#
# 4. Fill in all SMTP credentials from your mail provider
#
# 5. Set CORS_ORIGINS to your production domain(s) ONLY
#
# 6. Deploy with Docker Compose:
#    docker-compose --env-file backend/.env.prod up -d
#
# 7. Verify deployment:
#    curl https://your-domain.com/health
#
# 8. Monitor logs:
#    docker-compose logs -f backend
#
# =============================================================================
