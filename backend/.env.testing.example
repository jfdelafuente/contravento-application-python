# =============================================================================
# ContraVento Backend - TESTING Environment Variables
# =============================================================================
# This template is for PostgreSQL testing environment (minimal setup)
# Use this to test PostgreSQL compatibility before staging
# Copy to .env.testing and customize values

# =============================================================================
# APPLICATION
# =============================================================================

APP_NAME=ContraVento-Testing
APP_ENV=testing
DEBUG=true  # Enable debug mode to see detailed errors

# =============================================================================
# DATABASE - PostgreSQL (Testing)
# =============================================================================

# PostgreSQL connection URL for testing
# Uses separate test database and credentials
DATABASE_URL=postgresql+asyncpg://contravento_test:test_password@localhost:5432/contravento_test

# Note: Create database manually first:
# docker exec -it contravento-db psql -U postgres -c "
#   CREATE DATABASE contravento_test;
#   CREATE USER contravento_test WITH PASSWORD 'test_password';
#   GRANT ALL PRIVILEGES ON DATABASE contravento_test TO contravento_test;
# "

# =============================================================================
# SECURITY - JWT & AUTHENTICATION
# =============================================================================

# Secret key for JWT signing (simple for testing, not for production)
SECRET_KEY=test-secret-key-min-32-characters-for-jwt-signing-do-not-use-in-production

# JWT algorithm
ALGORITHM=HS256

# Token expiration
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=30

# =============================================================================
# SECURITY - PASSWORD HASHING
# =============================================================================

# Bcrypt rounds (4 is faster for testing, production uses 12)
BCRYPT_ROUNDS=4

# =============================================================================
# EMAIL / SMTP - Testing
# =============================================================================

# Option 1: No email (fails silently or skips email tests)
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=test@contravento.com
SMTP_TLS=false

# Option 2: MailHog (if running)
# Start MailHog: docker run -d -p 1025:1025 -p 8025:8025 mailhog/mailhog
# SMTP_HOST=localhost
# SMTP_PORT=1025

# =============================================================================
# FILE STORAGE
# =============================================================================

# Storage path (local for testing)
STORAGE_PATH=./storage_test

# Upload limits
UPLOAD_MAX_SIZE_MB=5
PROFILE_PHOTO_SIZE=400

# =============================================================================
# TRAVEL DIARY - SETTINGS
# =============================================================================

MAX_PHOTOS_PER_TRIP=20
MAX_TAGS_PER_TRIP=10

# Photo quality settings
PHOTO_QUALITY_OPTIMIZED=85
PHOTO_QUALITY_THUMB=80
PHOTO_MAX_WIDTH=1200
PHOTO_THUMB_SIZE=200

# =============================================================================
# CORS - Testing (Allow all localhost ports)
# =============================================================================

CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:8080,http://localhost:8000

# =============================================================================
# RATE LIMITING - Relaxed for testing
# =============================================================================

LOGIN_MAX_ATTEMPTS=10  # More attempts for testing
LOGIN_LOCKOUT_MINUTES=5  # Shorter lockout
VERIFICATION_EMAIL_MAX_PER_HOUR=10

# =============================================================================
# LOGGING
# =============================================================================

# Log level (DEBUG to see everything)
LOG_LEVEL=DEBUG

# Log format (text is easier to read during testing)
LOG_FORMAT=text

# =============================================================================
# SERVER
# =============================================================================

HOST=0.0.0.0
PORT=8000

# =============================================================================
# TESTING QUICK START INSTRUCTIONS
# =============================================================================
#
# 1. Copy this file:
#    cp .env.testing.example .env.testing
#
# 2. Start PostgreSQL only:
#    docker-compose up postgres -d
#
# 3. Create test database:
#    docker exec -it contravento-db psql -U postgres -c "
#      CREATE DATABASE contravento_test;
#      CREATE USER contravento_test WITH PASSWORD 'test_password';
#      GRANT ALL PRIVILEGES ON DATABASE contravento_test TO contravento_test;
#    "
#
# 4. Apply migrations:
#    cd backend
#    poetry run alembic upgrade head
#
# 5. Start backend:
#    poetry run uvicorn src.main:app --reload --port 8000
#
# 6. Run tests:
#    poetry run pytest
#
# 7. Clean up:
#    docker-compose down
#    docker-compose down -v  # To delete data
#
# =============================================================================
